(this["webpackJsonpsocial-media"]=this["webpackJsonpsocial-media"]||[]).push([[0],{54:function(e,t,s){"use strict";s.r(t);var n=s(0),a=s.n(n),c=s(23),r=s.n(c),l=s(4),o=s(25),i=s(24),d=localStorage;!function(){var e=d.getItem("users"),t=d.getItem("posts");"undefined"!==e&&null!==e||d.setItem("users",JSON.stringify([])),"undefined"!==t&&null!==t||d.setItem("posts",JSON.stringify([]))}();var u=function(e){d.setItem("auth",e)},b=Object(i.createSlice)({name:"posts",initialState:[],reducers:{createPost:function(e,t){var s,n=t.payload.post;n.likes=[],n.comments=[],e.push(n),s=e,d.setItem("posts",JSON.stringify(s))},loadPostsFromStorage:function(e,t){e.splice(0,e.length);var s,n=function(){var e=d.getItem("posts");return JSON.parse(e)}(),a=Object(o.a)(n);try{for(a.s();!(s=a.n()).done;){var c=s.value;e.push(c)}}catch(r){a.e(r)}finally{a.f()}},deletePost:function(e,t){},updatePost:function(e,t){},likePost:function(e,t){var s=t.payload,n=s.userId,a=s.postId,c=e[e.findIndex((function(e){return e.id===a}))].likes;c.includes(n)?c.splice(c.indexOf(n),1):c.push(n)},createComment:function(e,t){var s=t.payload,n=s.postId,a=s.userId,c=s.content;e[e.findIndex((function(e){return e.id===n}))].comments.push({userId:a,content:c})}}}),j=b.actions,m=j.createPost,O=j.loadPostsFromStorage,h=j.likePost,x=j.createComment,f=b.reducer,p=s(57),g=(0,s(24).createSlice)({name:"users",initialState:[],reducers:{loadUsersFromStorage:function(e,t){var s=function(){var e=d.getItem("users");return JSON.parse(e)}();e.splice(0,e.length);var n,a=Object(o.a)(s);try{for(a.s();!(n=a.n()).done;){var c=n.value;e.push(c)}}catch(r){a.e(r)}finally{a.f()}},createUser:function(e,t){var s,n=t.payload.user,a={username:n.username,password:n.password,id:Object(p.a)()};e.push(a),s=e,d.setItem("users",JSON.stringify(s))},deleteUser:function(e,t){var s=t.payload.id;e.splice(e.findIndex((function(e){return e.id===s})),1)},setUsers:function(e,t){var s=t.payload.users;for(var n in console.log(s),e.splice(0,e.length),s)e.push(n)}}}),v=g.actions,N=v.createUser,I=(v.setUsers,v.loadUsersFromStorage),y=g.reducer,C=(0,s(24).configureStore)({reducer:{users:y,posts:f}}),S=(0,s(0).createContext)({}),w=s(11);var k,F=function(){var e=Object(l.c)((function(e){return e.users})),t=Object(n.useState)(null),s=Object(w.a)(t,2),a=s[0],c=s[1],r=Object(n.useState)(null),o=Object(w.a)(r,2),i=o[0],d=o[1];return Object(n.useEffect)((function(){}),[a]),{loggedIn:a,user:i,login:function(t){var s=function(e,t){var s=e.username,n=e.password;return t.find((function(e){return e.username===s&&e.password===n}))||!1}(t,e);return!!s&&(c(!0),d(s),u(s.id),!0)},loginWithId:function(t){setTimeout((function(){if(t){var s=e.find((function(e){return e.id===t}));s&&(c(!0),d(s))}}),0)},logout:function(){c(!1),d(null),u(null)}}},L=s(14),U=s(1),P=function(e){return Object(U.jsx)("li",{className:"nav-item",children:Object(U.jsx)(L.b,{to:e.to,className:"nav-link",children:e.children})})},J=function(){var e=Object(n.useContext)(S),t=e.loggedIn?Object(U.jsx)("button",{className:"btn btn-outline-danger",onClick:function(){return e.logout()},children:"Logout"}):Object(U.jsx)("button",{type:"button",className:"btn btn-outline-success","data-bs-toggle":"modal","data-bs-target":"#modalLogin",children:"Login"});return Object(U.jsx)("nav",{className:"navbar-expand-sm p-2 navbar navbar-expand-sm navbar-dark bg-dark d-flex justify-content-between",children:Object(U.jsxs)("div",{className:"container-fluid",children:[Object(U.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbar",children:Object(U.jsx)("span",{className:"navbar-toggler-icon"})}),Object(U.jsx)("div",{className:"navbar-brand",children:Object(U.jsx)("h3",{children:"SocialMedia"})}),Object(U.jsxs)("div",{className:"collapse navbar-collapse",id:"navbar",children:[Object(U.jsxs)("ul",{className:"navbar-nav me-auto",children:[Object(U.jsx)(P,{to:"/home",children:"Home"}),Object(U.jsx)(P,{to:"/users",children:"Users"})]}),Object(U.jsxs)("div",{className:"d-flex",children:[t," "," ",Object(U.jsx)("button",{className:"btn btn-outline-primary ml-2","data-bs-toggle":"modal","data-bs-target":"#modal-register",style:{marginLeft:"7px"},children:"Register"})]})]})]})})},E=function(){return Object(U.jsx)("header",{children:Object(U.jsx)(J,{})})},M=(s(51),s(53),s(5)),T=s(35),R=s(38),D=s(28),V=function(e){var t=e.comments,s=e.postId,a=Object(n.useContext)(S),c=Object(l.b)(),r=Object(D.a)({initialValues:{content:""},onSubmit:function(e){var t={postId:s,userId:a.user.id,content:e.content};c(x(t))}}),o=t.map((function(e){return Object(U.jsxs)("li",{className:"list-group-item",children:[Object(U.jsx)("span",{style:{fontWeight:"600"},children:e.authorUsername}),"   ",e.content]},Object(p.a)())}));return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("form",{onSubmit:r.handleSubmit,className:"p-2",children:[Object(U.jsx)("div",{className:"",children:Object(U.jsx)("input",{className:"form-control",placeholder:"Comment",name:"content",value:r.values.content,onChange:r.handleChange,disabled:!a.loggedIn})}),Object(U.jsx)("div",{className:"mt-1",children:Object(U.jsx)("input",{type:"submit",className:"form-control btn btn-outline-secondary",value:"Leave",disabled:!a.loggedIn})})]}),Object(U.jsx)("ul",{className:"list-group",children:o})]})},W=R.a.button(k||(k=Object(T.a)(["\n  white-space: pre;\n"]))),B=function(e){var t=Object(l.c)((function(e){return e.users})),s=Object(l.b)(),a=Object(n.useContext)(S),c=e.post,r=c.id,o=c.authorId,i=c.title,d=c.content,u=c.likes,b=c.comments,j=t.find((function(e){return e.id===o})).username;b=b.map((function(e){return{content:e.content,authorUsername:t.find((function(t){return t.id===e.userId})).username}}));var m=function(){s(h({userId:a.user.id,postId:r}))},O=!(!a.loggedIn||!a.user)&&!!u.includes(a.user.id)?Object(U.jsxs)(W,{className:"btn btn-outline-success",onClick:m,disabled:!a.loggedIn,children:[u.length,"  |  Liked"]}):Object(U.jsxs)(W,{className:"btn btn-outline-danger",onClick:m,disabled:!a.loggedIn,children:[u.length,"  |  Like"]});return Object(U.jsx)("li",{className:"row",children:Object(U.jsxs)("div",{className:"mt-4 card col-12 ffset-2 p-0 border border-dark",children:[Object(U.jsx)("div",{className:"card-header",children:Object(U.jsx)(L.b,{to:"/users/".concat(j),children:j})}),Object(U.jsxs)("div",{className:"card-body",children:[Object(U.jsx)("h4",{className:"card-title",children:i}),Object(U.jsx)("p",{className:"card-text",children:d})]}),Object(U.jsxs)("div",{className:"card-footer text-end",children:[O," ",Object(U.jsx)("a",{href:"#a".concat(r),"data-bs-toggle":"collapse",className:"btn btn-outline-primary",children:"Comments"})]}),Object(U.jsx)("div",{className:"collapse",id:"a".concat(r),children:Object(U.jsx)(V,{comments:b,postId:r})})]})})},H=function(e){var t=e.posts.map((function(e){return Object(U.jsx)(B,{post:e},Object(p.a)())}));return Object(U.jsx)("ul",{className:"container-fluid",children:t})},q=function(){var e=Object(n.useContext)(S),t=Object(l.b)(),s=Object(D.a)({initialValues:{title:"",content:""},onSubmit:function(n){var a=n.title,c=n.content;if(e.loggedIn&&""!==n.title.trim()&&""!==n.content.trim()){var r=Object(p.a)(),l=e.user.id;t(m({post:{id:r,authorId:l,title:a,content:c,likes:[]}})),s.resetForm()}}});return Object(U.jsxs)("form",{className:"container-fluid",onSubmit:s.handleSubmit,children:[Object(U.jsx)("div",{className:"row",children:Object(U.jsx)("input",{className:"form-control",placeholder:"Title",name:"title",value:s.values.title,onChange:s.handleChange,disabled:!e.loggedIn})}),Object(U.jsx)("div",{className:"row mt-1",children:Object(U.jsx)("textarea",{className:"form-control",name:"content",placeholder:"Content",value:s.values.content,onChange:s.handleChange,disabled:!e.loggedIn})}),Object(U.jsx)("div",{className:"row mt-1",children:Object(U.jsx)("button",{type:"submit",className:"btn btn-outline-primary",disabled:!e.loggedIn,children:"Creat post"})})]})},z=function(){var e,t=Object(l.c)((function(e){return e.posts})),s=Object(n.useContext)(S);return Object(U.jsxs)(U.Fragment,{children:[s.loggedIn?Object(U.jsxs)("h1",{className:"text-center",children:["Hi ",null===(e=s.user)||void 0===e?void 0:e.username,"!"]}):Object(U.jsx)("h1",{className:"text-center",children:"Please Login!"}),Object(U.jsx)(q,{}),Object(U.jsx)(H,{posts:t})]})},A=function(){var e=Object(M.g)().username,t=Object(l.c)((function(e){return e.users})),s=Object(l.c)((function(e){return e.posts})),n=t.find((function(t){return t.username===e})),a=s.filter((function(e){return e.authorId===n.id}));return Object(U.jsxs)("div",{children:[Object(U.jsx)("h1",{className:"text-center",children:e}),Object(U.jsx)(H,{posts:a})]})},G=function(){var e=Object(l.c)((function(e){return e.users})).map((function(e){return Object(U.jsxs)("li",{className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",children:[e.username,Object(U.jsx)(L.b,{to:"/users/".concat(e.username),children:Object(U.jsx)("button",{className:"btn btn-outline-warning",children:"View"})})]},Object(p.a)())}));return Object(U.jsxs)("div",{className:"",children:[Object(U.jsx)("h1",{className:"text-center",children:"Users"}),Object(U.jsx)("ul",{className:"list-group p-3",children:e})]})},K=function(){return Object(U.jsx)("main",{className:"p-3 col-xs-12 col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 col-xl-4 offset-xl-4 border",children:Object(U.jsxs)(M.d,{children:[Object(U.jsx)(M.b,{path:"/",exact:!0,children:Object(U.jsx)(M.a,{to:"/home"})}),Object(U.jsx)(M.b,{path:"/home",exact:!0,children:Object(U.jsx)(z,{})}),Object(U.jsx)(M.b,{path:"/users",exact:!0,children:Object(U.jsx)(G,{})}),Object(U.jsx)(M.b,{path:"/users/:username",exact:!0,children:Object(U.jsx)(A,{})})]})})},Q=s(20),X=s(2),Y=function(){var e=Object(n.useState)(""),t=Object(w.a)(e,2),s=t[0],a=t[1],c=Object(n.useContext)(S),r=Object(n.useState)({username:"",password:""}),l=Object(w.a)(r,2),o=l[0],i=l[1];Object(n.useEffect)((function(){return setTimeout((function(){return a("")}),2e3)}),[s]);var d=function(e){i(Object(X.a)(Object(X.a)({},o),{},Object(Q.a)({},e.target.name,e.target.value)))},u=function(e){e.preventDefault();var t={username:o.username,password:o.password};c.login(t)?(i({username:"",password:""}),document.getElementById("modal-close-btn").click()):a("Failed to login")};return Object(U.jsx)("form",{onSubmit:u,className:"modal fade",id:"modalLogin",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(U.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:Object(U.jsxs)("div",{className:"modal-content",children:[Object(U.jsxs)("div",{className:"modal-header",children:[Object(U.jsxs)("h5",{className:"modal-title",id:"exampleModalLabel",children:["Login ",Object(U.jsx)("span",{className:"text-danger",children:s})]}),Object(U.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(U.jsxs)("div",{className:"modal-body",children:[Object(U.jsxs)("div",{className:"mb-2",children:[Object(U.jsx)("label",{htmlFor:"#usernameField",className:"form-label",children:"Username"}),Object(U.jsx)("input",{className:"form-control",name:"username",id:"usernameField",value:o.username,onChange:d})]}),Object(U.jsxs)("div",{className:"mb-2",children:[Object(U.jsx)("label",{htmlFor:"#passwordField",className:"form-label",children:"Password"}),Object(U.jsx)("input",{className:"form-control",id:"passwordField",name:"password",value:o.password,onChange:d})]})]}),Object(U.jsxs)("div",{className:"modal-footer",children:[Object(U.jsx)("button",{type:"submit",className:"btn btn-outline-primary",onClick:u,children:"Login"}),Object(U.jsx)("button",{className:"btn btn-outline-dark","data-bs-dismiss":"modal",id:"modal-close-btn",children:"Close"})]})]})})})},Z=function(){var e=Object(n.useState)(""),t=Object(w.a)(e,2),s=t[0],a=t[1],c=Object(l.b)(),r=Object(l.c)((function(e){return e.users})),o=Object(n.useRef)(),i=Object(n.useState)({username:"",password:""}),d=Object(w.a)(i,2),u=d[0],b=d[1];Object(n.useEffect)((function(){return setTimeout((function(){return a("")}),2e3)}),[s]);var j=function(e){b(Object(X.a)(Object(X.a)({},u),{},Object(Q.a)({},e.target.name,e.target.value)))};return Object(U.jsx)("form",{onSubmit:function(e){e.preventDefault(),r.find((function(e){return e.username===u.username}))?a("Username already used!"):(c(N({user:u})),b({username:"",password:""}),o.current.click())},className:"modal fade",id:"modal-register",tabIndex:"-1",children:Object(U.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:Object(U.jsxs)("div",{className:"modal-content",children:[Object(U.jsxs)("div",{className:"modal-header",children:[Object(U.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Register"}),Object(U.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(U.jsxs)("div",{className:"modal-body",children:[Object(U.jsxs)("div",{className:"mb-2",children:[Object(U.jsxs)("label",{htmlFor:"#usernameField",className:"form-label",children:["Username ",Object(U.jsx)("span",{className:"text-danger",children:s})]}),Object(U.jsx)("input",{className:"form-control",name:"username",id:"usernameField",value:u.username,onChange:j})]}),Object(U.jsxs)("div",{className:"mb-2",children:[Object(U.jsx)("label",{htmlFor:"#passwordField",className:"form-label",children:"Password"}),Object(U.jsx)("input",{className:"form-control",id:"passwordField",name:"password",value:u.password,onChange:j})]})]}),Object(U.jsxs)("div",{className:"modal-footer",children:[Object(U.jsx)("button",{type:"submit",className:"btn btn-outline-primary",children:"Register"}),Object(U.jsx)("button",{className:"btn btn-outline-dark","data-bs-dismiss":"modal",id:"modal-close-btn",ref:o,children:"Close"})]})]})})})},$=function(){var e=F(),t=Object(l.b)();return console.log("Test"),e.loginWithId(function(){var e=d.getItem("auth");return"undefined"!==e&&null!==e&&e}()),document.addEventListener("DOMContentLoaded",(function(){t(I({})),t(O({}))})),Object(U.jsx)(S.Provider,{value:e,children:Object(U.jsx)(L.a,{basename:"/social-media",children:Object(U.jsxs)("div",{className:"container-fluid p-0",children:[Object(U.jsx)(E,{}),Object(U.jsx)(K,{}),Object(U.jsx)(Y,{}),Object(U.jsx)(Z,{})]})})})};r.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)(l.a,{store:C,children:Object(U.jsx)($,{})})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.4c97c78b.chunk.js.map